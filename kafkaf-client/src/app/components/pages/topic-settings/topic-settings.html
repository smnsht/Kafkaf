<app-page-wrapper [state]="store.pageState()">
  <app-search placeholder="Search by key or value" [search]="search" />

  <div style="overflow-y: scroll; max-height: 80vh">
    <table appKafkafTable>
      <thead>
        <tr>
          <th>Key</th>
          <th>Value</th>
          <th>Default Value</th>
        </tr>
      </thead>
      <tbody>
        @for (row of filteredSettings(); track $index) {
          <tr>
            <td>{{ row.name }}</td>
            <td>
              @if ($index === selectedRowIndex) {
                <div class="buttons">
                  <button class="button is-small" (click)="selectedRowIndex = -1">
                    <span class="icon is-small">
                      <i class="fas fa-times"></i>
                    </span>
                    <span>Cancel</span>
                  </button>
                  <button
                    class="button is-small"
                    [class.loading]="store.loading()"
                    [disabled]="!ctrl.isValid()"
                    (click)="update(row.name, ctrl.value())"
                  >
                    <span class="icon is-small">
                      <i class="fas fa-save"></i>
                    </span>
                    <span>Save</span>
                  </button>
                </div>
                <app-topic-setting-input [configKey]="row.name" [value]="row.value" #ctrl />
              } @else {
                <button class="button is-small mr-2" (click)="selectedRowIndex = $index">
                  <span class="icon is-small">
                    <i class="fas fa-edit"></i>
                  </span>
                  <span>Edit</span>
                </button>
                {{ row.value }}
              }
            </td>
            <td>{{ row.defaultValue }}</td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</app-page-wrapper>
